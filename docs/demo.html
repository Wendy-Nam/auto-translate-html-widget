<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Translation Widget Test</title>

    <script src="../index.html"></script>
</head>

<body>
    <h1>Widget Preview</h1>
    <p>This is a test page to preview the translation widget.</p>
    <!-- ğŸŒ Start of Multilingual Translate Widget -->
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ğŸ§© ì‚¬ìš©ì ì§€ì • ê°€ëŠ¥ í…Œë§ˆ ë³€ìˆ˜ / Customizable Theme Variables -->
    <style>
        :root {
            --wrapper-bg: #1f2937;
            /* ë°”íƒ•ìƒ‰ / Background (Slate-800) */
            --wrapper-border: #374151;
            /* í…Œë‘ë¦¬ / Border (Slate-700) */
            --label-color: #f8fafc;
            /* í…ìŠ¤íŠ¸ / Label Text (Slate-50) */
            --btn-bg: #334155;
            /* ë²„íŠ¼ ë°°ê²½ / Button Background (Slate-700) */
            --btn-hover-bg: #475569;
            /* ë²„íŠ¼ hover / Button Hover Background (Slate-600) */
            --btn-text: #f1f5f9;
            /* ë²„íŠ¼ í…ìŠ¤íŠ¸ / Button Text (Slate-100) */
            --btn-active-bg: #fbbf24;
            /* ì„ íƒëœ ë²„íŠ¼ ë°°ê²½ / Active Button Background (Yellow-400) */
            --btn-active-text: #1f2937;
            /* ì„ íƒëœ ë²„íŠ¼ í…ìŠ¤íŠ¸ / Active Button Text (Slate-800) */
        }

        .lang-btn {
            background-color: var(--btn-bg);
            /* ê¸°ë³¸ ë°°ê²½ìƒ‰ / Default background color */
            color: var(--btn-text);
            /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ / Text color */
            transition: all 0.2s ease;
            /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ / Smooth transition */
        }

        .lang-btn:hover {
            background-color: var(--btn-hover-bg);
            /* í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ / Hover background color */
        }

        .lang-btn.active {
            background-color: var(--btn-active-bg) !important;
            /* í™œì„±í™”ëœ ë²„íŠ¼ ë°°ê²½ / Active button background */
            color: var(--btn-active-text) !important;
            /* í™œì„±í™”ëœ ë²„íŠ¼ í…ìŠ¤íŠ¸ / Active button text */
        }
    </style>

    <!-- ğŸ”’ Google ë²ˆì—­ê¸° ì—˜ë¦¬ë¨¼íŠ¸ (ìˆ¨ê¹€ ì²˜ë¦¬) / Google Translate element (hidden) -->
    <div id="google_translate_element" class="hidden"></div>
    <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <!-- ğŸŒ ì–¸ì–´ ì„ íƒ UI / Language Switcher UI -->
    <div id="lang-switcher" class="max-w-xs mt-4">
        <div class="flex flex-col items-start gap-2 border p-3 shadow-sm rounded"
            style="background-color: var(--wrapper-bg); border-color: var(--wrapper-border);">
            <div class="flex items-center gap-2">
                <!-- í…ìŠ¤íŠ¸ ë¼ë²¨(LANGUAGE)ì— 'notranslate' í´ë˜ìŠ¤ ì ìš© / Prevent label text from being translated -->
                <span class="text-lg">ğŸŒ</span>
                <span class="text-xl font-semibold notranslate" style="color: var(--label-color);">LANGUAGE</span>
            </div>
            <div class="flex flex-wrap gap-2 mt-1">
                <button class="lang-btn rounded px-2.5 py-0.5" data-lang="ko" title="í•œêµ­ì–´">
                    <img src="https://tistory4.daumcdn.net/tistory/4029016/skin/images/ko.png" class="h-8 w-8" />
                </button>
                <button class="lang-btn rounded px-2.5 py-0.5" data-lang="en" title="English">
                    <img src="https://tistory4.daumcdn.net/tistory/4029016/skin/images/en.png" class="h-8 w-8" />
                </button>
                <button class="lang-btn rounded px-2.5 py-0.5" data-lang="zh-CN" title="ä¸­æ–‡(ç®€ä½“)">
                    <img src="https://tistory4.daumcdn.net/tistory/4029016/skin/images/zh-CN.png" class="h-8 w-8" />
                </button>
                <button class="lang-btn rounded px-2.5 py-0.5" data-lang="ja" title="æ—¥æœ¬èª">
                    <img src="https://tistory4.daumcdn.net/tistory/4029016/skin/images/ja.png" class="h-8 w-8" />
                </button>
            </div>
        </div>
    </div>

    <!-- ğŸ§  ë™ì‘ ìŠ¤í¬ë¦½íŠ¸ / Behavior Script -->
    <script>
        // ğŸŒ Google ë²ˆì—­ ìœ„ì ¯ ì´ˆê¸°í™”
        // EN: Initialize Google Translate widget
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'ko', // ê¸°ë³¸ í˜ì´ì§€ ì–¸ì–´ / Default page language
                autoDisplay: false // ìë™ íŒì—… ë¹„í™œì„±í™” / Disable auto popup
            }, 'google_translate_element');
        }
        // ì–¸ì–´ì½”ë“œ ì •ê·œí™” í•¨ìˆ˜ (í˜„ì¬ zh-CNë§Œ ì²˜ë¦¬)
        // EN: Normalize language code (currently only for zh-CN)
        const normalizeLangCode = (code) => (code === 'zh-CN' ? 'zh-CN' : code);
        const gtcombo = () => document.querySelector('.goog-te-combo');
        const buttons = document.querySelectorAll('.lang-btn');
        const defaultLang = 'ko';

        // URL íŒŒë¼ë¯¸í„° ì¶”ì¶œ í•¨ìˆ˜
        // EN: Extract query parameter from URL
        const getUrlParam = (name) => {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        };

        // ì„ íƒëœ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ê°±ì‹ 
        // EN: Highlight active language button
        const updateStyles = (selected) => {
            buttons.forEach(btn => btn.classList.remove('active'));
            const active = Array.from(buttons).find(b => b.dataset.lang === selected);
            if (active) active.classList.add('active');
        };

        // ì–¸ì–´ ì ìš© ì²˜ë¦¬ í•¨ìˆ˜
        // EN: Apply language via dropdown + store in localStorage
        const applyLang = (lang, force = false) => {
            const currentLang = localStorage.getItem('selected-lang');
            if (!force && currentLang === lang) return;
            // Google ë²ˆì—­ ì…€ë ‰íŠ¸ë°•ìŠ¤ DOM ê°€ì ¸ì˜¤ê¸°
            // EN: Get Google Translate dropdown DOM
            const combo = gtcombo();
            if (!combo) return;

            combo.value = normalizeLangCode(lang); // ì…€ë ‰íŠ¸ë°•ìŠ¤ ê°’ ë³€ê²½
            combo.dispatchEvent(new Event('change')); // ë³€ê²½ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
            localStorage.setItem('selected-lang', lang); // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì €ì¥
            updateStyles(lang); // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ê°±ì‹ 
        };

        // ì´ˆê¸° ë˜ëŠ” í˜ì´ì§€ ì´ë™ ì‹œ ì–¸ì–´ ì¬ì ìš©
        // EN: Re-apply language on load or navigation
        const reapplyLang = () => {
            const urlLang = getUrlParam('lang'); // ?lang=xx URL íŒŒë¼ë¯¸í„°
            const storedLang = localStorage.getItem('selected-lang');
            const initialLang = urlLang || storedLang || defaultLang;

            updateStyles(initialLang);
            setTimeout(() => applyLang(initialLang, true), 50);
        };

        window.addEventListener('load', reapplyLang);
        window.addEventListener('popstate', reapplyLang);

        // pushState / replaceState ê°ì§€ í›„ ì–¸ì–´ ì¬ì ìš©
        // EN: Intercept SPA navigation changes
        const interceptHistoryChange = (fnName) => {
            const original = history[fnName];
            history[fnName] = function () {
                original.apply(this, arguments);
                reapplyLang();
            };
        };

        interceptHistoryChange('pushState');
        interceptHistoryChange('replaceState');
        // ê° ì–¸ì–´ ë²„íŠ¼ í´ë¦­ ì‹œ ì–¸ì–´ ì „í™˜
        // EN: Language button click event
        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                const toLang = btn.dataset.lang;
                const currentLang = localStorage.getItem('selected-lang') || defaultLang;

                if (toLang === currentLang) return; // ì¤‘ë³µ í´ë¦­ ë°©ì§€ / prevent redundant action
                applyLang(toLang, true);
            });
        });
    </script>
    <!-- ğŸŒ End of Multilingual Translate Widget -->
    <!-- ğŸ§ª Start of Example HTML Content -->
    <div class="min-h-screen bg-gray-100 py-10 px-4">
        <!-- ë¸”ë¡œê·¸ ì†Œê°œ ì¹´ë“œ -->
        <div class="max-w-xl mx-auto rounded-2xl shadow-lg bg-white p-6 space-y-6">
            <div class="text-center">
                <h1 class="text-3xl font-bold text-gray-800">Welcome to My Blog</h1>
                <p class="mt-2 text-gray-600">Here youâ€™ll find content in both English and Korean!</p>
            </div>
            <!-- ë‚´ìš© ì˜ì—­ -->
            <div class="space-y-4 text-gray-700">
                <p>This is a sample paragraph written in English.</p>

                <h2 class="text-xl font-semibold text-blue-600">ì—¬ê¸°ëŠ” í•œêµ­ì–´ ë¬¸ë‹¨ì…ë‹ˆë‹¤</h2>
                <p>í•œêµ­ì–´ë¡œë„ ë‚´ìš©ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìë™ ë²ˆì—­ì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                <ul class="list-disc list-inside space-y-1">
                    <li>Item 1: English</li>
                    <li>í•­ëª© 2: í•œêµ­ì–´</li>
                </ul>

                <a href="https://example.com" class="inline-flex items-center gap-1 text-blue-500 hover:underline">
                    ğŸ”— External Link
                </a>
            </div>
            <!-- ë³„ì  ë° í›„ì› ìœ ë„ -->
            <div class="text-center pt-4 border-t border-gray-200">
                <p class="text-sm text-gray-500 mb-2">ğŸ’¬ ì´ ì½˜í…ì¸ ê°€ ìœ ìµí•˜ì…¨ë‹¤ë©´,</p>
                <p class="font-medium text-gray-700">â­ ë³„í‘œë¥¼ ëˆŒëŸ¬ì£¼ì‹œê±°ë‚˜, â˜• ì»¤í”¼ í•œ ì” í›„ì›í•´ ì£¼ì„¸ìš”!</p>
            </div>
        </div>
        <!-- â˜• Ko-fi ìœ„ì ¯ ìŠ¤í¬ë¦½íŠ¸ -->
        <iframe id='kofiframe' src='https://ko-fi.com/wendynam/?hidefeed=true&widget=true&embed=true&preview=true'
            style='border:none;width:100%;padding:4px;background:#f9f9f9;' height='712' title='wendynam'></iframe>
    </div>
    <!-- ğŸ§ª End of Example HTML Content -->
</body>

</html>